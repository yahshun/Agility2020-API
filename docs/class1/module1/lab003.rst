Lab – Create the Access Policy
------------------------------------------------

In this section, edit the policy using Visual Policy Editor to enable users to login via AD+MFA, then transition to CertSSO

Task – Open Visual Policy Editor
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



#. On the CERT_SSO profile line **click** edit under Per-Session Policy

|image8|

#. **Click** the + symbol located on the fallback branch located between the Start and Deny boxes

|image9|

#. Select **Logon Page** under the Logon Tab 
#. Click **Add Item**

|image11|

#. Add an additional field to the logon page by selecting **password ** from the Type dropdown on line 3
#. Enter **OTP** for Post Variable Name
#. Enter **OTP** for Session Variable Name
#. Enter **OTP** for Logon Page Input Field #3
#. **Click** Save
|image12|

#. **Click** the + symbol located on the fallback branch located between the Logon Page and Deny boxes

|image13|

#. Select **RADIUS Auth** under the Authentication Tab 
#. Click **Add Item**

|image14|

#. Select **RADIUS_SERVERS** from the AAA Server dropdown box
#. Change the password source to **%{session.logon.last.OTP}**
#. **Click** Save

|image15|

#. **Click** the + symbol located on the Successful branch located between RADIUS Auth and Deny boxes
#. Click **Add Item**

|image16|

#. Select **AD Auth** under the Authentication Tab
#. Click **Add Item**

|image17|


#. Select **f5lab.local** from the Server dropdown box
#. **Click** Save

|image18|

#. **Click** the + symbol located on the Successful branch located between AD Auth and Deny box
#. Click **Add Item**

|image10|

#. Select **Variable Assign** under the Assignment Tab
#. Click **Add Item**

|image19|

#. **Click** the Deny ending icon located on the fallback branch of the Variable Assign Agent

|image20|

#. **Click** Allow
#. **Click** Save

|image21|

#. **Apply Access Policy** located in the top left corner to commit the policy changes




























#. Enter the IP address **10.1.10.100**
#. Select **acme.com-wildcard** from the Client SSL certificate dropdown box
#. Select **acme.com-wild ard** from the Associated Private Key dropdown box
#. Select **ca.f5lab.local** from the Trusted Certificate Authorities for Client Authentication drop down box

|image9|

#. Select **serverssl** from the Server SSL Profile options
#. **Click** Save & Next

|image10|




.. |image8| image:: /media/image008.png
.. |image9| image:: /media/image009.png
.. |image10| image:: /media/image010.png
.. |image11| image:: /media/image011.png
.. |image12| image:: /media/image012.png
.. |image13| image:: /media/image013.png
.. |image14| image:: /media/image014.png
.. |image15| image:: /media/image015.png
.. |image16| image:: /media/image016.png
.. |image17| image:: /media/image017.png
.. |image18| image:: /media/image018.png
.. |image19| image:: /media/image019.png
.. |image20| image:: /media/image020.png
.. |image21| image:: /media/image021.png
.. |image22| image:: /media/image022.png
